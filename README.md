# NotoSansã¸ç½®æ›ã™ã‚‹ã‚„ã¤(æ”¹ä¿®å‹)

[![Version](https://img.shields.io/badge/version-2.0.26-blue.svg)](https://github.com/1llum1n4t1s/replace-font)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

èª­ã¿ã¥ã‚‰ã„æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã‚’è‡ªå‹•çš„ã« **Noto Sans** ã«ç½®æ›ã™ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶æ‹¡å¼µæ©Ÿèƒ½ã§ã™ã€‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æ¸ˆã¿ã€‚

## ğŸ¯ ç‰¹å¾´

- âš¡ **é«˜é€Ÿå‡¦ç†**: æœ€é©åŒ–ã•ã‚ŒãŸãƒ•ã‚©ãƒ³ãƒˆãƒ—ãƒªãƒ­ãƒ¼ãƒ‰æ©Ÿæ§‹
- ğŸ”„ **è‡ªå‹•æ¤œå‡º**: è¤‡æ•°ã®æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã‚’è‡ªå‹•ã§æ¤œå‡ºãƒ»ç½®æ›
- ğŸ–¼ï¸ **iframeå¯¾å¿œ**: å‹•çš„ã«è¿½åŠ ã•ã‚Œã‚‹iframeå†…ã®ãƒ•ã‚©ãƒ³ãƒˆã‚‚ç½®æ›
- ğŸŒ **CSPå¯¾å¿œ**: JavaScriptçµŒç”±ã§ã®CSSæ³¨å…¥ã«ã‚ˆã‚Šå³æ ¼ãªCSPã‚µã‚¤ãƒˆã§ã‚‚å‹•ä½œ
- ğŸ”® **Shadow DOMå¯¾å¿œ**: Web Componentsã‚’ä½¿ç”¨ã—ãŸã‚µã‚¤ãƒˆã§ã‚‚æ­£å¸¸ã«å‹•ä½œ
- ğŸ¨ **ã‚«ã‚¹ã‚¿ãƒ ã‚¢ã‚¤ã‚³ãƒ³**: SVGã‹ã‚‰è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã‚¢ã‚¤ã‚³ãƒ³
- ğŸš€ **Manifest V3**: æœ€æ–°ã®Chromeæ‹¡å¼µä»•æ§˜ã«å¯¾å¿œ
- ğŸ’¾ **è»½é‡**: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚©ãƒ³ãƒˆãŒãªã„å ´åˆã¯æ‹¡å¼µæ©Ÿèƒ½å†…è”µãƒ•ã‚©ãƒ³ãƒˆ(Noto Sans JP)ã‚’èª­ã¿è¾¼ã‚€

## ğŸ“¥ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### Chrome
https://chromewebstore.google.com/detail/ipfbjlmjgfobhnncbggaaiknhdgkcdfe

## ğŸ”¤ ãƒ•ã‚©ãƒ³ãƒˆç½®æ›

### é€šå¸¸ãƒ†ã‚­ã‚¹ãƒˆ
ã™ã¹ã¦ã®ãƒ†ã‚­ã‚¹ãƒˆãŒ **Noto Sans JP** ã«ç½®æ›ã•ã‚Œã¾ã™ã€‚

### ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯
ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆ`<code>`, `<pre>` ãªã©ï¼‰ã«ã¯ **UDEV Gothic JPDOC** ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚

- **UDEV Gothic JPDOC**: ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å‘ã‘ã®ç­‰å¹…ãƒ•ã‚©ãƒ³ãƒˆ
  - BIZ UDã‚´ã‚·ãƒƒã‚¯ + JetBrains Mono ã®åˆæˆãƒ•ã‚©ãƒ³ãƒˆ
  - æ—¥æœ¬èªæ–‡æ›¸é »å‡ºè¨˜å·ãŒå…¨è§’è¡¨ç¤º
  - 0ï¼ˆã‚¼ãƒ­ï¼‰ãŒã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚¼ãƒ­ã§ `O`ï¼ˆã‚ªãƒ¼ï¼‰ã¨åŒºåˆ¥ã—ã‚„ã™ã„

**ã‚¦ã‚§ã‚¤ãƒˆå¯¾å¿œ**: Regular (400) ã¨ Bold (700)

## ğŸ”§ å®Ÿè£…ã®è©³ç´°

### ã‚³ã‚¢ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼

#### ãƒ•ã‚©ãƒ³ãƒˆé…ä¿¡
- **preload-fonts.js**: Manifest V3å¯¾å¿œã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
  - `document_start`ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§é«˜é€Ÿå®Ÿè¡Œ
  - CSS Font Loading APIã‚’ä½¿ç”¨ã—ãŸåŠ¹ç‡çš„ãªãƒ•ã‚©ãƒ³ãƒˆèª­ã¿è¾¼ã¿
  - è¤‡æ•°ã‚¦ã‚§ã‚¤ãƒˆã®å‹•çš„ç®¡ç†

#### ãƒ•ã‚©ãƒ³ãƒˆå¤‰æ›
- **convert-fonts.js**: TTFâ†’WOFF2å¤‰æ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
  - TTFãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•æ¤œå‡ºã—ã¦WOFF2ã«å¤‰æ›
  - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’ç´„50%å‰Šæ¸›
  - æ—¢å­˜ã®WOFF2ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚¹ã‚­ãƒƒãƒ—

#### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- **WeakSet**: é‡è¤‡å‡¦ç†ã‚’é˜²æ­¢ï¼ˆiframeå‡¦ç†ï¼‰
- **DocumentFragment**: DOMæ“ä½œã®ãƒãƒƒãƒåŒ–
- **Debounce**: è¤‡æ•°iframeåŒæ™‚è¿½åŠ æ™‚ã®åŠ¹ç‡åŒ–ï¼ˆ100msï¼‰
- **requestIdleCallback**: ãƒ–ãƒ©ã‚¦ã‚¶ä½™è£•æ™‚ã®ãƒªã‚½ãƒ¼ã‚¹è§£æ”¾

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
manifest.json
â”œâ”€â”€ Content Script (preload-fonts.js)
â”‚   â”œâ”€â”€ CSSæ³¨å…¥ï¼ˆãƒ¡ã‚¤ãƒ³ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€Shadow DOMï¼‰
â”‚   â””â”€â”€ MutationObserverï¼ˆShadow DOMæ¤œå‡ºï¼‰
â”œâ”€â”€ CSS (universal-override.css)
â”‚   â”œâ”€â”€ Noto Sans JPï¼ˆé€šå¸¸ãƒ†ã‚­ã‚¹ãƒˆç”¨ï¼‰
â”‚   â””â”€â”€ UDEV Gothic JPDOCï¼ˆã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ç”¨ï¼‰
â”œâ”€â”€ ãƒ•ã‚©ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ NotoSansJP-Regular.woff2
â”‚   â”œâ”€â”€ NotoSansJP-Bold.woff2
â”‚   â”œâ”€â”€ UDEVGothicJPDOC-Regular.woff2
â”‚   â””â”€â”€ UDEVGothicJPDOC-Bold.woff2
â”œâ”€â”€ ã‚¢ã‚¤ã‚³ãƒ³ç”Ÿæˆ (generate-icons.js)
â”‚   â””â”€â”€ SVG â†’ PNG (16x16, 48x48, 128x128)
â”œâ”€â”€ ãƒ•ã‚©ãƒ³ãƒˆå¤‰æ› (convert-fonts.js)
â”‚   â””â”€â”€ TTF â†’ WOFF2
â””â”€â”€ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆç”Ÿæˆ (generate-screenshots.js)
    â””â”€â”€ HTML â†’ PNG (1280x800, 640x400, 440x280, 1400x560)
```

### ç½®ãæ›ãˆä»•çµ„ã¿

1. **ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ã‚»ãƒ¬ã‚¯ã‚¿**ã§å…¨è¦ç´ ã®ãƒ•ã‚©ãƒ³ãƒˆã‚’å¼·åˆ¶çš„ã«ç½®æ›ï¼ˆ`!important`ï¼‰
2. **CSS Font Loading API**ã§æ˜ç¤ºçš„ã«ãƒ•ã‚©ãƒ³ãƒˆèª­ã¿è¾¼ã¿
3. **è¤‡æ•°ã‚¦ã‚§ã‚¤ãƒˆå¯¾å¿œ**ã§ç´°å­—ãƒ»å¤ªå­—ã‚’å€‹åˆ¥ç®¡ç†
4. **ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚©ãƒ³ãƒˆå„ªå…ˆ**ã§é«˜é€ŸåŒ–ï¼ˆOSã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç‰ˆã‚ã‚Œã°ä½¿ç”¨ï¼‰

**æ³¨æ„**: ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ `@font-face` ã§ãƒ•ã‚©ãƒ³ãƒˆåã‚’å†å®šç¾©ã™ã‚‹æ–¹æ³•ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã—ãŸãŒã€æœ€æ–°ã®Chromeã§ã¯ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚©ãƒ³ãƒˆãŒå„ªå…ˆã•ã‚Œã‚‹ãŸã‚ã€ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ã‚»ãƒ¬ã‚¯ã‚¿ã«ã‚ˆã‚‹å¼·åˆ¶ç½®æ›ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚

## ğŸ› ï¸ é–‹ç™ºè€…å‘ã‘

### ãƒ“ãƒ«ãƒ‰æ–¹æ³•

```bash
# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install

# ã‚¢ã‚¤ã‚³ãƒ³ç”Ÿæˆ
npm run generate-icons

# ãƒ•ã‚©ãƒ³ãƒˆå¤‰æ›ï¼ˆTTFãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆï¼‰
npm run convert-fonts

# ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆç”Ÿæˆï¼ˆChrome Web Storeç”¨ï¼‰
npm run generate-screenshots

# ã™ã¹ã¦ãƒ“ãƒ«ãƒ‰ + ZIPä½œæˆ
# Windows PowerShell
.\zip.ps1

# Mac / Linux
./zip.sh
```

### ç”Ÿæˆã•ã‚Œã‚‹ç”»åƒ

`zip.ps1` / `zip.sh` ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ç”»åƒãŒ `webstore-images/` ã«è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ï¼š

- **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ**: 1280x800 ãŠã‚ˆã³ 640x400ï¼ˆæœ€å¤§5æšï¼‰
- **ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ«ï¼ˆå°ï¼‰**: 440x280
- **ãƒãƒ¼ã‚­ãƒ¼ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ«**: 1400x560

ã™ã¹ã¦ PNG å½¢å¼ï¼ˆ24ãƒ“ãƒƒãƒˆã€ã‚¢ãƒ«ãƒ•ã‚¡ãªã—ï¼‰ã§ Chrome Web Store ã®ä»•æ§˜ã«æº–æ‹ ã—ã¦ã„ã¾ã™ã€‚

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [MIT License](LICENSE) ã®ä¸‹ã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ã€‚

### ãƒ•ã‚©ãƒ³ãƒˆãƒ©ã‚¤ã‚»ãƒ³ã‚¹

Noto Sans JP ã¯ [SIL Open Font License 1.1](fonts/LICENSE) ã®ä¸‹ã§æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚


## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

Issueå ±å‘Šã‚„Pull Requestã‚’æ­“è¿ã—ã¾ã™ã€‚

---

## English

This is a browser extension that automatically replaces hard-to-read Japanese fonts with **Noto Sans**. Performance optimized.

### Features

- âš¡ High-performance font preloading mechanism
- ğŸ”„ Automatic detection and replacement of multiple Japanese fonts
- ğŸ–¼ï¸ Support for dynamically added iframes
- ğŸ¨ Custom icons generated from SVG
- ğŸš€ Chrome Extension Manifest V3 compliant
- ğŸ’¾ Lightweight with subset fonts for fast loading

### Replaced Fonts

- **Normal text**: Replaced with **Noto Sans JP**
- **Code blocks**: Replaced with **UDEV Gothic JPDOC** (monospace font for programming)

### Implementation Details

#### Core Technologies
- **Manifest V3 Compliant**: Uses native extension API
- **CSS Font Loading API**: Efficient asynchronous font loading
- **WeakSet-based Deduplication**: Prevents duplicate processing
- **DOM Batching**: Uses DocumentFragment for performance
- **Debounce Mechanism**: Optimizes handling of multiple iframes

#### Performance Features
- Preload at `document_start` for early initialization
- Local font fallback (Noto Sans JP, Noto Sans CJK)
- Automatic resource cleanup via requestIdleCallback
- Optimized CSS generation with dynamic weight variants

### License

MIT License - See [LICENSE](LICENSE) file for details.

Noto Sans JP fonts are licensed under the [SIL Open Font License 1.1](fonts/LICENSE).
